<!DOCTYPE html>
<html>
<head>
    <title>å›¾ç‰‡ç²˜è´´æµ‹è¯•</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        #info { background: #f0f0f0; padding: 10px; margin: 10px 0; white-space: pre-wrap; font-family: monospace; font-size: 12px; max-height: 300px; overflow: auto; }
        #preview { border: 2px solid #333; padding: 20px; margin: 10px 0; min-height: 200px; }
        textarea { width: 100%; height: 200px; font-family: monospace; }
    </style>
</head>
<body>
    <h1>ğŸ–¼ï¸ å›¾ç‰‡ç²˜è´´æµ‹è¯•</h1>
    <p>1. ä»é£ä¹¦æ–‡æ¡£å¤åˆ¶å¸¦å›¾ç‰‡çš„å†…å®¹</p>
    <p>2. ç‚¹å‡»ä¸‹é¢çš„æ¡†ï¼ŒæŒ‰ Ctrl+V ç²˜è´´</p>
    <p>3. æŸ¥çœ‹è°ƒè¯•ä¿¡æ¯</p>
    
    <textarea id="pasteArea" placeholder="ç‚¹å‡»è¿™é‡Œï¼Œç„¶åç²˜è´´..."></textarea>
    
    <h3>è°ƒè¯•ä¿¡æ¯ï¼š</h3>
    <div id="info"></div>
    
    <h3>é¢„è§ˆï¼š</h3>
    <div id="preview"></div>
    
    <script>
        const pasteArea = document.getElementById('pasteArea');
        const info = document.getElementById('info');
        const preview = document.getElementById('preview');
        
        function log(msg) {
            info.textContent += msg + '\n';
            console.log(msg);
        }
        
        pasteArea.addEventListener('paste', function(e) {
            e.preventDefault();
            info.textContent = '';
            log('=== ç²˜è´´äº‹ä»¶ ===');
            
            const clipboardData = e.clipboardData || window.clipboardData;
            
            // è·å–æ‰€æœ‰æ ¼å¼
            const types = clipboardData.types;
            log('å¯ç”¨æ ¼å¼: ' + JSON.stringify(types));
            
            // è·å– HTML
            const html = clipboardData.getData('text/html');
            log('HTML é•¿åº¦: ' + (html ? html.length : 0));
            
            if (html) {
                // æ£€æŸ¥å›¾ç‰‡
                const imgCount = (html.match(/<img/gi) || []).length;
                log('å›¾ç‰‡æ ‡ç­¾æ•°é‡: ' + imgCount);
                
                // æå–å›¾ç‰‡ src
                const imgRegex = /<img[^>]+src="([^"]+)"/gi;
                let match;
                let i = 0;
                while ((match = imgRegex.exec(html)) !== null) {
                    const src = match[1];
                    log(`å›¾ç‰‡ ${++i}: ${src.substring(0, 100)}${src.length > 100 ? '...' : ''}`);
                    
                    if (src.startsWith('data:image')) {
                        log(`  â†’ ç±»å‹: base64, å¤§å°: ${Math.round(src.length / 1024)}KB`);
                    } else if (src.startsWith('http')) {
                        log(`  â†’ ç±»å‹: åœ¨çº¿å›¾ç‰‡`);
                    }
                }
                
                // æ˜¾ç¤ºé¢„è§ˆ
                preview.innerHTML = html;
                
                // æ˜¾ç¤ºåœ¨ textarea
                pasteArea.value = html;
            }
            
            // ä¹Ÿè·å–çº¯æ–‡æœ¬
            const text = clipboardData.getData('text/plain');
            log('\nçº¯æ–‡æœ¬é•¿åº¦: ' + (text ? text.length : 0));
        });
    </script>
</body>
</html>
