# 微信公众号排版助手 - 产品文档

## 📋 文档信息

| 项目 | 内容 |
|------|------|
| **产品名称** | 微信公众号排版助手 |
| **版本** | v1.0.0 |
| **产品类型** | Web 应用工具 |
| **目标用户** | 微信公众号运营者、内容创作者、新媒体编辑 |
| **最后更新** | 2026-01-31 |

---

## 🎯 产品概述

### 产品定位
一款专业的微信公众号文章排版工具，帮助内容创作者快速将 Markdown 或飞书文档转换为精美的微信公众号格式文章。

### 核心价值
- **效率提升**：从手动排版到一键生成，节省 80% 排版时间
- **视觉专业**：17 款精心设计的主题，涵盖各种场景风格
- **格式完美**：100% 保留微信编辑器格式，复制即用
- **操作简单**：左侧编辑，右侧预览，一键复制

### 使用场景
- ✅ 公众号文章排版
- ✅ 飞书/语雀文档迁移到公众号
- ✅ Markdown 笔记转换为公众号格式
- ✅ 快速尝试不同视觉风格
- ✅ 团队协作统一排版规范

---

## 🌟 核心功能

### 1. 多格式输入支持

#### 1.1 Markdown 编辑
- **实时预览**：左侧输入，右侧即时渲染
- **语法高亮**：支持完整的 Markdown 语法
- **快捷键**：`Cmd+Enter` 复制、`Cmd+K` 清空

**支持的 Markdown 语法**：
```markdown
# 标题 (H1-H6)
## 二级标题
### 三级标题

**加粗** *斜体* ***加粗斜体*** ~~删除线~~

> 引用文字

- 无序列表
1. 有序列表

[链接](https://example.com)
![图片](https://example.com/image.jpg)

`行内代码`

```
代码块
```

| 表格 | 支持 |
|------|------|
| 列1  | 列2  |

---
分割线
```

#### 1.2 飞书/语雀文档直接粘贴
- **保留图片**：粘贴飞书文档，图片自动保留
- **保留格式**：标题、列表、引用等格式自动识别
- **无需转换**：直接 Ctrl+C / Ctrl+V 即可

#### 1.3 Word 文档上传
- **支持格式**：.docx (Word 2007+)
- **自动解析**：使用 mammoth.js 提取文本和格式
- **批量处理**：支持大文件（最大 10MB）

---

### 2. 9 款精美主题

#### 2.1 经典主题（3款）

##### 🌅 晨露 · 极简奶油
- **风格**：温暖柔和，大地色系
- **配色**：奶油色 #fffdfa + 大地棕 #8b7355
- **特点**：圆润边角、柔和阴影
- **适用场景**：生活方式、随笔、情感类、女性用户

##### 🏙️ 都市 · 杂志编辑
- **风格**：现代杂志排版
- **配色**：纯黑 #000 + 荧光黄 #ffeb3b
- **特点**：粗黑标题、荧光笔标记、强烈对比
- **适用场景**：商业报告、科技、时尚、快讯

##### 🌲 森系 · 自然治愈
- **风格**：自然森林风格
- **配色**：森林绿 #4a7c59 + 暖木色
- **特点**：有机圆角、植物元素、温暖质感
- **适用场景**：旅行、生活、环保、户外、自然教育

#### 2.2 特色风格（6款）

##### 🏮 国潮 · 新中式
- 中国传统色彩 + 现代排版
- 红金配色、祥云图案

##### 🎋 侘寂 · 日式极简
- 不完美美学
- 原木色、纸质纹理

##### 🎞️ 胶片 · 复古怀旧
- 暖色调、颗粒感
- 拍立得风格

##### ✏️ 手绘 · 插画风格
- 手写字体
- 涂鸦边框、便签效果

##### 🌸 清新 · 文艺自然
- 粉嫩配色
- 花朵元素、温柔风格

##### 🏭 工业 · 硬核机能
- 金属质感
- 黄黑配色、技术风

---

### 3. 一键复制到微信

#### 3.1 核心功能
- **格式保留**：100% 保留样式、格式、图片
- **内联样式**：自动转换为微信兼容的内联样式
- **双重保障**：Clipboard API + 降级方案

#### 3.2 使用方式
1. 编辑内容
2. 选择主题
3. 点击"📋 一键复制"按钮
4. 打开微信公众号编辑器
5. 粘贴（Cmd+V / Ctrl+V）
6. 完成！

#### 3.3 技术原理
```javascript
// Markdown → HTML → 内联样式 → 剪贴板
Markdown 文本
  ↓ (marked.parse)
HTML 结构
  ↓ (应用主题样式)
带内联样式的 HTML
  ↓ (Clipboard API)
剪贴板（text/html 格式）
  ↓ (粘贴到微信)
完美保留格式
```

---

### 4. 实时预览与编辑

#### 4.1 左右分栏布局
```
┌─────────────┬─────────────┐
│  左侧编辑区  │  右侧预览区  │
│             │             │
│  Markdown   │  微信样式   │
│  输入       │  实时预览   │
│             │             │
└─────────────┴─────────────┘
```

#### 4.2 实时更新
- **输入即预览**：每个字符输入都会触发更新
- **防抖处理**：避免频繁渲染影响性能
- **智能识别**：自动识别 Markdown 和 HTML

#### 4.3 状态栏信息
- **字符数统计**：实时显示字符数
- **字数统计**：实时显示字数（中文模式）
- **快捷键提示**：显示可用快捷键

---

### 5. 键盘快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Cmd+Enter` | 复制到微信 | 快速复制到剪贴板 |
| `Cmd+K` | 清空编辑器 | 清空所有内容 |
| `Cmd+S` | 提示信息 | 提示使用 Cmd+Enter 复制 |
| `Cmd+1~5` | 快速切换主题 | 切换前 5 个主题 |
| `Cmd+Shift+C` | 全局复制 | 不在编辑器时也可复制 |

---

## 🎨 设计规范

### 1. 视觉设计原则

#### 1.1 留白与呼吸感
- **段落间距**：1.8-2.0 倍行高
- **边距**：充足的内外边距
- **视觉层次**：清晰的信息层级

#### 1.2 字体规范
- **标题字重**：600-700
- **正文字号**：15.5px - 16.5px
- **行高**：1.75 - 2.0
- **字体族**：
  - 中文：PingFang SC, Hiragino Sans GB, Microsoft YaHei
  - 英文：SF Pro Display, Segoe UI, Roboto
  - 代码：SF Mono, Monaco, Consolas

#### 1.3 色彩系统
- **主色**：每个主题 3-5 个主色
- **辅助色**：渐变、阴影、强调色
- **背景色**：根据主题风格选择
- **文字色**：确保对比度符合 WCAG AA 标准

### 2. 组件设计规范

#### 2.1 标题样式
```css
H1: 28-36px, 字重 600-800, 上边距 40-52px
H2: 21-22px, 字重 600-700, 上边距 36-44px
H3: 17px, 字重 600, 上边距 26-28px
```

#### 2.2 引用块样式
- **圆角**：12-16px
- **内边距**：20-28px
- **背景**：浅色背景或边框
- **可选**：左侧装饰线

#### 2.3 代码块样式
- **行内代码**：背景色、圆角、不同字体
- **代码块**：深色背景、语法高亮、等宽字体
- **内边距**：20-24px
- **圆角**：8-12px

#### 2.4 列表样式
- **缩进**：2.2-2.5em
- **项目间距**：8-10px
- **列表符号**：根据主题风格定制

#### 2.5 图片样式
- **宽度**：max-width 100%
- **对齐**：居中显示
- **间距**：上下 28-36px
- **圆角**：12-20px（部分主题）

#### 2.6 表格样式
- **宽度**：100%
- **表头**：背景色、字重 600
- **单元格**：内边距 12-16px
- **边框**：底部边框 1-2px

---

## 🛠️ 技术规格

### 1. 技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| **前端框架** | 原生 JavaScript (ES6+) | 核心逻辑 |
| **样式** | 原生 CSS3 | 主题样式 |
| **Markdown 解析** | marked.js 9.1.6 | Markdown → HTML |
| **Word 解析** | mammoth.js 1.6.0 | Word → HTML |
| **剪贴板** | clipboard.js 2.0.11 | 复制功能 |
| **代码高亮** | highlight.js 11.9.0 | 代码块高亮 |
| **XSS 防护** | DOMPurify 3.0.6 | 安全防护（可选） |

### 2. 浏览器兼容性

| 浏览器 | 最低版本 | 说明 |
|--------|---------|------|
| Chrome | 66+ | ✅ 完全支持 |
| Safari | 13.1+ | ✅ 完全支持 |
| Firefox | 63+ | ✅ 完全支持 |
| Edge | 79+ | ✅ 完全支持 |
| IE 11 | ❌ | 不支持 |

### 3. 文件格式支持

| 格式 | 扩展名 | 支持 |
|------|--------|------|
| Markdown | .md, .markdown | ✅ |
| 纯文本 | .txt | ✅ |
| Word | .docx | ✅ |
| 飞书/语雀 | 直接粘贴 | ✅ |
| HTML | .html | ⚠️ 部分支持 |

### 4. 文件限制

| 限制项 | 限制值 | 说明 |
|--------|--------|------|
| 最大文件大小 | 10MB | 防止浏览器卡顿 |
| Markdown 最大长度 | 100万字符 | 防止性能问题 |
| 图片数量 | 无限制 | 建议不超过 50 张 |
| 图片大小 | 不限制 | 建议单张 < 5MB |

---

## 📖 使用指南

### 1. 快速上手

#### 步骤 1：打开应用
```
浏览器访问: http://localhost:8888
```

#### 步骤 2：输入内容
**方式 A：直接输入 Markdown**
- 在左侧编辑器输入
- 实时预览右侧效果

**方式 B：粘贴飞书文档**
1. 在飞书中打开文档
2. 全选（Cmd+A）
3. 复制（Cmd+C）
4. 粘贴到左侧编辑器（Cmd+V）

**方式 C：上传 Word 文档**
1. 点击"📄 上传文档"按钮
2. 选择 .docx 文件
3. 等待解析完成

#### 步骤 3：选择主题
- 点击顶部主题选择器
- 从 17 个主题中选择
- 右侧实时预览效果

#### 步骤 4：复制到微信
1. 点击"📋 一键复制"按钮
2. 或按快捷键 `Cmd+Enter`
3. 打开微信公众号编辑器
4. 粘贴（Cmd+V）
5. 完成！

---

### 2. 高级技巧

#### 2.1 飞书图片保留技巧
1. 在飞书中正常复制文章
2. 粘贴到左侧编辑器
3. 系统自动保留图片链接
4. 确保图片是公网可访问的 URL

#### 2.2 主题自定义
当前版本不支持自定义主题，但你可以：
- 选择最接近需求的主题
- 提交主题建议给开发者
- 等待自定义功能上线

#### 2.3 批量处理
1. 准备好多个 Markdown 文件
2. 逐个打开、处理、复制
3. 或等待批量导入功能上线

---

### 3. 常见问题 FAQ

#### Q1：复制到微信后格式乱了？
**A**: 请确保：
- 使用"一键复制"按钮，而不是手动选择复制
- 使用最新版 Chrome/Safari 浏览器
- 微信编辑器处于"源码模式"关闭状态

#### Q2：图片不显示？
**A**: 检查：
- 图片 URL 是否是 https://
- 图片是否需要登录才能访问
- 尝试在浏览器中直接打开图片 URL

#### Q3：复制功能不工作？
**A**: 确保使用：
- localhost（本地访问）
- 或 https:// 网站
- http:// 在某些浏览器可能不支持

#### Q4：如何快速切换主题？
**A**: 使用快捷键：
- `Cmd+1`：晨露
- `Cmd+2`：墨韵
- `Cmd+3`：都市
- `Cmd+4`：森系
- `Cmd+5`：极夜

#### Q5：支持夜间模式吗？
**A**: 当前不支持，但"极夜"主题是深色风格，可以作为替代。

---

## 📊 主题对比表

| 主题 | 风格 | 适用场景 | 字号 | 行高 | 主色调 |
|------|------|----------|------|------|--------|
| 晨露 | 温暖柔和 | 生活随笔 | 16px | 1.9 | #fffdfa |
| 墨韵 | 东方美学 | 文化读书 | 16.5px | 2.0 | #fcfcfa |
| 都市 | 杂志编辑 | 商业科技 | 15.5px | 1.75 | #ffffff |
| 森系 | 自然治愈 | 旅行环保 | 16px | 1.9 | #fafbf7 |
| 极夜 | 深色科技 | 技术极客 | 15.5px | 1.85 | #0d1117 |
| 国潮 | 新中式 | 国风文化 | 16px | 1.9 | #fef5e7 |
| 侘寂 | 日式极简 | 生活美学 | 16px | 2.0 | #f7f4ed |
| 赛博 | 未来科技 | 科技游戏 | 15px | 1.8 | #0a0e27 |
| 胶片 | 复古怀旧 | 回忆录 | 16px | 1.9 | #f5e6d3 |
| 手绘 | 插画风格 | 漫画教程 | 16px | 1.85 | #fff9e6 |
| 商务 | 极简专业 | 商业报告 | 15px | 1.8 | #ffffff |
| 清新 | 文艺自然 | 青春校园 | 16px | 1.9 | #fefef6 |
| 工业 | 硬核机能 | 技术文档 | 15px | 1.75 | #1a1a1a |
| 海洋 | 波浪美学 | 旅游海洋 | 16px | 1.9 | #f0f9ff |
| 星空 | 夜语星辰 | 夜读情感 | 16px | 1.9 | #1a1a2e |
| 自然 | 森语叶韵 | 环保自然 | 16px | 1.9 | #f7f9f7 |
| 几何 | 线条艺术 | 设计艺术 | 16px | 1.85 | #fafafa |

---

## 🚧 已知问题

### 1. 当前版本限制

| 问题 | 影响 | 计划修复 |
|------|------|---------|
| 不支持自定义主题 | 无法个性化配色 | v2.0 |
| 无批量导入 | 需逐个处理文件 | v1.5 |
| 无历史记录 | 无法查看最近使用 | v1.5 |
| 无导出功能 | 无法保存为文件 | v1.5 |
| 无协作功能 | 无法团队共享 | v2.0 |
| 主题预览不实时 | 需切换才能看到 | v1.2 |

### 2. 兼容性问题

| 环境 | 问题 | 解决方案 |
|------|------|---------|
| IE 11 | 不支持 Clipboard API | 使用现代浏览器 |
| HTTP 网站 | 复制功能受限 | 使用 HTTPS 或 localhost |
| 移动端 Safari | 部分主题错位 | 使用 PC 端 |
| 微信内置浏览器 | 部分样式不支持 | 复制后再次粘贴 |

### 3. 安全提示

⚠️ **安全建议**：
- 不要从不明来源复制内容
- 注意 XSS 攻击风险
- 定期更新浏览器
- 敏感信息请先检查后再发布

---

## 🗺️ 产品路线图

### v1.1 - 计划中（2周内）
- [ ] 主题预览功能
- [ ] 拖拽文件上传
- [ ] 字数统计优化
- [ ] 快捷键帮助面板

### v1.2 - 计划中（1个月内）
- [ ] 历史记录功能
- [ ] 收藏主题
- [ ] 自定义字体大小
- [ ] 移动端适配优化

### v1.5 - 计划中（2-3个月）
- [ ] 批量导入文件
- [ ] 导出为 HTML/PDF
- [ ] 云端保存
- [ ] 团队协作

### v2.0 - 计划中（3-6个月）
- [ ] 自定义主题编辑器
- [ ] AI 推荐主题
- [ ] 在线协作编辑
- [ ] API 接口

---

## 📞 支持与反馈

### 问题反馈
- GitHub Issues: [项目地址]
- 邮件: support@example.com
- 微信: 微信公众号排版助手

### 功能建议
欢迎通过以下方式提交建议：
- 在 GitHub 提交 Issue
- 发送邮件到产品团队
- 在用户群中讨论

### 商务合作
- 企业版咨询
- 定制开发
- 技术支持

---

## 📄 附录

### A. Markdown 快速参考

```markdown
# 一级标题
## 二级标题
### 三级标题

**加粗** *斜体* ***加粗斜体*** ~~删除线~~

> 引用文字
> 可以多行

- 无序列表
  - 嵌套项

1. 有序列表
2. 第二项

[链接文字](https://example.com)
![图片描述](https://example.com/image.jpg)

`行内代码`

```
代码块
```

| 表头1 | 表头2 |
|-------|-------|
| 内容1 | 内容2 |

---
分割线
```

### B. 快捷键速查表

| Mac | Windows | 功能 |
|-----|---------|------|
| `Cmd+Enter` | `Ctrl+Enter` | 复制到微信 |
| `Cmd+K` | `Ctrl+K` | 清空编辑器 |
| `Cmd+S` | `Ctrl+S` | 提示信息 |
| `Cmd+1~5` | `Ctrl+1~5` | 切换主题 |
| `Cmd+A` | `Ctrl+A` | 全选 |
| `Cmd+C` | `Ctrl+C` | 复制 |
| `Cmd+V` | `Cmd+V` | 粘贴 |

### C. 主题选择建议

| 内容类型 | 推荐主题 | 备选主题 |
|---------|---------|---------|
| 情感故事 | 晨露、墨韵 | 清新、胶片 |
| 科技文章 | 极夜、赛博 | 工业、商务 |
| 商业报告 | 都市、商务 | 工业、极夜 |
| 旅行游记 | 森系、自然 | 海洋、清新 |
| 国学文化 | 墨韵、国潮 | 晨露 |
| 漫画教程 | 手绘 | 清新、胶片 |
| 技术文档 | 极夜、工业 | 都市、商务 |

### D. 文件大小建议

| 内容类型 | 建议大小 | 说明 |
|---------|---------|------|
| 短文章 | < 5KB | < 2000 字 |
| 中等文章 | 5-50KB | 2000-20000 字 |
| 长文章 | 50-200KB | 20000-80000 字 |
| 超长文章 | 200KB+ | > 80000 字，建议分篇 |

---

**文档版本**: v1.0
**最后更新**: 2026-01-31
**维护团队**: 微信公众号排版助手产品团队
